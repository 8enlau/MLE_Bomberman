import matplotlib.pyplot as plt
from IPython import display
from contextlib import contextmanager
import sys, os
import numpy as np
from callbacks import MODEL_FILE

# plt.ion()
params = f'\
    \n    coin collected: 50 \
    \n    waited: -10 \
    \n    invalid action: -2 \
    \n    repetitive action: -50 \
    \n    killed self: -10 \
    \n    coin found: 5\
    \n    crate destroyed: 1'

@contextmanager
def surpress_stdout():
    with open(os.devnull, "w") as devnull:
        old_stdout = sys.stdout
        sys.stdout = devnull
        try:
            yield
        finally:
            sys.stdout = old_stdout

def plot(scores, mean_scores, name):
    with surpress_stdout():
        display.clear_output(wait=True)
        display.display(plt.gcf())
        plt.clf()
        plt.title('Training...')
        plt.xlabel('Number of Games')
        plt.ylabel(f'{name}')
        plt.plot(scores)
        plt.plot(mean_scores)
        plt.ylim(ymin=0)
        plt.text(len(scores)-1, scores[-1], str(scores[-1]))
        plt.text(len(mean_scores)-1, mean_scores[-1], str(mean_scores[-1]))
        plt.show(block=False)
        plt.pause(.1)

def train_graph():
    coins = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    mean_coins = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    steps = [0, 39, 100, 80, 45, 51, 191, 62, 5, 24, 65, 50, 158, 35, 14, 103, 154, 96, 77, 14, 49, 6, 49, 64, 36, 47, 72, 13, 14, 15, 16, 24, 30, 27, 30, 28, 18, 18, 14, 30, 32, 32, 130, 13, 157, 75, 29, 102, 31, 100, 44, 18, 26, 97, 64, 82, 61, 15, 298, 56, 130, 25, 148, 8, 30, 149, 153, 7, 24, 19, 68, 41, 169, 161, 27, 21, 154, 193, 40, 13, 44, 47, 13, 38, 83, 85, 45, 67, 117, 104, 43, 68, 6, 11, 67, 59, 58, 34, 52, 89, 38, 15, 181, 23, 29, 31, 74, 7, 28, 134, 63, 89, 28, 140, 328, 120, 123, 14, 23, 41, 201, 161, 99, 16, 49, 45, 82, 38, 15, 113, 31, 38, 163, 112, 50, 80, 97, 76, 61, 20, 39, 53, 11, 13, 36, 76, 333, 124, 15, 70, 28, 14, 22, 78, 7, 57, 13, 101, 18, 72, 63, 9, 24, 16, 82, 13, 86, 72, 16, 179, 12, 19, 35, 23, 29, 24, 8, 18, 9, 25, 9, 87, 18, 50, 56, 9, 8, 148, 50, 21, 25, 44, 42, 8, 115, 87, 65, 50, 12, 5, 110, 155, 24, 15, 33, 8, 37, 82, 20, 8, 138, 28, 46, 105, 5, 7, 79, 15, 13, 9, 23, 48, 44, 143, 48, 26, 23, 67, 174, 11, 35, 32, 36, 46, 24, 43, 81, 137, 57, 68, 23, 95, 18, 34, 42, 63, 239, 107, 34, 42, 24, 111, 68, 122, 114, 86, 15, 206, 11, 7, 97, 222, 107, 23, 74, 57, 67, 48, 176, 18, 38, 14, 85, 56, 31, 55, 166, 46, 7, 40, 5, 31, 76, 16, 187, 29, 42, 74, 51, 5, 176, 26, 189, 161, 114, 14, 62, 12, 22, 135, 145, 24, 118, 23, 53, 17, 31, 59, 386, 23, 146, 46, 21, 106, 30, 67, 7, 30, 20, 40, 19, 24, 14, 59, 91, 8, 117, 47, 61, 23, 18, 59, 34, 220, 45, 19, 12, 18, 15, 42, 32, 65, 16, 16, 13, 124, 31, 74, 96, 67, 39, 161, 11, 116, 41, 27, 5, 94, 100, 30, 12, 43, 314, 20, 43, 19, 83, 132, 35, 49, 80, 16, 5, 124, 18, 59, 211, 160, 26, 167, 21, 107, 19, 42, 70, 23, 174, 191, 46, 41, 49, 39, 44, 110, 87, 27, 110, 170, 225, 65, 12, 142, 56, 5, 68, 31, 122, 77, 82, 49, 55, 53, 17, 9, 48, 67, 14, 173, 8, 19, 9, 47, 75, 5, 80, 128, 76, 6, 18, 145, 121, 147, 9, 51, 124, 8, 42, 236, 32, 143, 64, 136, 33, 56, 125, 24, 6, 18, 33, 35, 29, 24, 33, 50, 21, 194, 22, 68, 354, 198, 171, 156, 8, 25, 175, 23, 69, 16, 19, 125, 84, 125, 62, 19, 27, 87, 7, 124, 171, 36, 79, 19, 12, 44, 46, 7, 31, 24, 87, 101, 7, 26, 10, 223, 21, 75, 13, 18, 181, 71, 268]
    mean_steps = [19.5, 46.333333333333336, 54.75, 52.8, 52.5, 72.28571428571429, 71.0, 63.666666666666664, 59.7, 60.18181818181818, 59.333333333333336, 66.92307692307692, 64.64285714285714, 61.266666666666666, 63.875, 69.17647058823529, 70.66666666666667, 71.0, 68.15, 67.23809523809524, 64.45454545454545, 63.78260869565217, 63.791666666666664, 62.68, 62.07692307692308, 62.44444444444444, 60.67857142857143, 59.06896551724138, 57.6, 56.25806451612903, 55.25, 54.484848484848484, 53.6764705882353, 53.0, 52.30555555555556, 51.37837837837838, 50.5, 49.56410256410256, 49.075, 48.65853658536585, 48.26190476190476, 50.16279069767442, 49.31818181818182, 51.71111111111111, 52.21739130434783, 51.723404255319146, 52.770833333333336, 52.326530612244895, 53.28, 53.09803921568628, 52.42307692307692, 51.924528301886795, 52.75925925925926, 52.96363636363636, 53.482142857142854, 53.6140350877193, 52.94827586206897, 57.101694915254235, 57.083333333333336, 58.278688524590166, 57.74193548387097, 59.17460317460318, 58.375, 57.93846153846154, 59.31818181818182, 60.71641791044776, 59.9264705882353, 59.405797101449274, 58.82857142857143, 58.95774647887324, 58.708333333333336, 60.21917808219178, 61.58108108108108, 61.12, 60.5921052631579, 61.8051948051948, 63.48717948717949, 63.18987341772152, 62.5625, 62.333333333333336, 62.146341463414636, 61.55421686746988, 61.273809523809526, 61.529411764705884, 61.80232558139535, 61.60919540229885, 61.67045454545455, 62.29213483146067, 62.75555555555555, 62.53846153846154, 62.59782608695652, 61.98924731182796, 61.4468085106383, 61.50526315789474, 61.479166666666664, 61.44329896907217, 61.16326530612245, 61.07070707070707, 61.35, 61.118811881188115, 60.666666666666664, 61.83495145631068, 61.46153846153846, 61.15238095238095, 60.867924528301884, 60.99065420560748, 60.49074074074074, 60.19266055045872, 60.86363636363637, 60.88288288288288, 61.13392857142857, 60.84070796460177, 61.53508771929825, 63.85217391304348, 64.33620689655173, 64.83760683760684, 64.40677966101696, 64.05882352941177, 63.86666666666667, 65.0, 65.78688524590164, 66.0569105691057, 65.65322580645162, 65.52, 65.35714285714286, 65.48818897637796, 65.2734375, 64.88372093023256, 65.25384615384615, 64.99236641221374, 64.78787878787878, 65.52631578947368, 65.8731343283582, 65.75555555555556, 65.86029411764706, 66.08759124087591, 66.15942028985508, 66.12230215827338, 65.79285714285714, 65.60283687943263, 65.51408450704226, 65.13286713286713, 64.77083333333333, 64.57241379310345, 64.65068493150685, 66.47619047619048, 66.86486486486487, 66.51677852348993, 66.54, 66.28476821192054, 65.9407894736842, 65.65359477124183, 65.73376623376623, 65.35483870967742, 65.30128205128206, 64.96815286624204, 65.19620253164557, 64.8993710691824, 64.94375, 64.93167701863354, 64.58641975308642, 64.33742331288343, 64.04268292682927, 64.15151515151516, 63.8433734939759, 63.97604790419162, 64.02380952380952, 63.739644970414204, 64.41764705882353, 64.11111111111111, 63.848837209302324, 63.68208092485549, 63.44827586206897, 63.25142857142857, 63.02840909090909, 62.717514124293785, 62.46629213483146, 62.167597765363126, 61.96111111111111, 61.668508287292816, 61.80769230769231, 61.568306010928964, 61.505434782608695, 61.475675675675674, 61.193548387096776, 60.90909090909091, 61.37234042553192, 61.31216931216931, 61.1, 60.910994764397905, 60.822916666666664, 60.72538860103627, 60.45360824742268, 60.733333333333334, 60.86734693877551, 60.888324873096444, 60.833333333333336, 60.58793969849246, 60.31, 60.55721393034826, 61.024752475247524, 60.8423645320197, 60.61764705882353, 60.482926829268294, 60.228155339805824, 60.11594202898551, 60.22115384615385, 60.02870813397129, 59.78095238095238, 60.15165876777251, 60.0, 59.93427230046948, 60.14485981308411, 59.88837209302326, 59.64351851851852, 59.73271889400922, 59.527522935779814, 59.31506849315068, 59.086363636363636, 58.92307692307692, 58.873873873873876, 58.80717488789238, 59.183035714285715, 59.13333333333333, 58.98672566371681, 58.82819383259912, 58.8640350877193, 59.366812227074234, 59.15652173913043, 59.05194805194805, 58.935344827586206, 58.836909871244636, 58.782051282051285, 58.63404255319149, 58.567796610169495, 58.66244725738397, 58.99159663865546, 58.98326359832636, 59.020833333333336, 58.871369294605806, 59.02066115702479, 58.851851851851855, 58.75, 58.68163265306122, 58.699186991869915, 59.42914979757085, 59.62096774193548, 59.51807228915663, 59.448, 59.30677290836653, 59.51190476190476, 59.54545454545455, 59.79133858267716, 60.003921568627455, 60.10546875, 59.929961089494164, 60.49612403100775, 60.30501930501931, 60.1, 60.241379310344826, 60.8587786259542, 61.034220532319395, 60.890151515151516, 60.93962264150943, 60.92481203007519, 60.947565543071164, 60.899253731343286, 61.3271375464684, 61.166666666666664, 61.08118081180812, 60.908088235294116, 60.99633699633699, 60.97810218978102, 60.86909090909091, 60.84782608695652, 61.227436823104696, 61.172661870503596, 60.97849462365591, 60.90357142857143, 60.704626334519574, 60.59929078014184, 60.65371024734982, 60.49647887323944, 60.940350877192984, 60.82867132867133, 60.76306620209059, 60.80902777777778, 60.77508650519031, 60.58275862068965, 60.97938144329897, 60.85958904109589, 61.29692832764505, 61.636054421768705, 61.813559322033896, 61.652027027027025, 61.65319865319865, 61.486577181208055, 61.35451505016722, 61.6, 61.87707641196013, 61.75165562913907, 61.93729372937294, 61.80921052631579, 61.78032786885246, 61.63398692810458, 61.534201954397396, 61.52597402597402, 62.57605177993528, 62.44838709677419, 62.71704180064309, 62.66346153846154, 62.53035143769968, 62.6687898089172, 62.56507936507936, 62.57911392405063, 62.40378548895899, 62.301886792452834, 62.1692789968652, 62.1, 61.965732087227416, 61.84782608695652, 61.69969040247678, 61.69135802469136, 61.78153846153846, 61.61656441717791, 61.78593272171254, 61.74085365853659, 61.73860182370821, 61.621212121212125, 61.48942598187311, 61.48192771084337, 61.3993993993994, 61.874251497005986, 61.82388059701493, 61.69642857142857, 61.54896142433235, 61.42011834319526, 61.283185840707965, 61.226470588235294, 61.14076246334311, 61.15204678362573, 61.02040816326531, 60.88953488372093, 60.75072463768116, 60.933526011560694, 60.847262247838614, 60.88505747126437, 60.98567335243553, 61.002857142857145, 60.94017094017094, 61.22443181818182, 61.08215297450425, 61.23728813559322, 61.180281690140845, 61.08426966292135, 60.92717086834734, 61.0195530726257, 61.128133704735376, 61.041666666666664, 60.905817174515235, 60.85635359116022, 61.553719008264466, 61.43956043956044, 61.38904109589041, 61.27322404371585, 61.33242506811989, 61.52445652173913, 61.452574525745256, 61.41891891891892, 61.46900269541779, 61.346774193548384, 61.19571045576407, 61.36363636363637, 61.248, 61.24202127659574, 61.63925729442971, 61.8994708994709, 61.80474934036939, 62.08157894736842, 61.973753280839894, 62.09162303664922, 61.97911227154047, 61.927083333333336, 61.94805194805195, 61.847150259067355, 62.13695090439276, 62.46907216494845, 62.426735218508995, 62.37179487179487, 62.33759590792839, 62.2780612244898, 62.23155216284987, 62.35279187817259, 62.415189873417724, 62.32575757575758, 62.44584382871537, 62.71608040201005, 63.12280701754386, 63.1275, 63.0, 63.19651741293532, 63.178660049627794, 63.03465346534654, 63.046913580246915, 62.967980295566505, 63.11302211302211, 63.14705882352941, 63.19315403422983, 63.15853658536585, 63.13868613138686, 63.11407766990291, 63.002421307506054, 62.871980676328505, 62.83614457831325, 62.84615384615385, 62.729016786570746, 62.99282296650718, 62.86157517899761, 62.75714285714286, 62.62945368171022, 62.59241706161137, 62.621749408983455, 62.485849056603776, 62.52705882352941, 62.68075117370892, 62.711943793911004, 62.57943925233645, 62.47552447552447, 62.66744186046512, 62.80278422273782, 62.99768518518518, 62.8729792147806, 62.845622119815665, 62.98620689655172, 62.86009174311926, 62.81235697940503, 63.20776255707762, 63.136674259681094, 63.31818181818182, 63.31972789115646, 63.484162895927604, 63.41534988713318, 63.398648648648646, 63.53707865168539, 63.44843049327354, 63.319910514541384, 63.21875, 63.15144766146993, 63.08888888888889, 63.01330376940133, 62.926991150442475, 62.86092715231788, 62.83259911894273, 62.74065934065934, 63.02850877192982, 62.93873085339168, 62.94978165938865, 63.5838779956427, 63.87608695652174, 64.10845986984816, 64.3073593073593, 64.18574514038878, 64.10129310344827, 64.33978494623656, 64.2510729613734, 64.26124197002142, 64.15811965811966, 64.06183368869937, 64.19148936170212, 64.23354564755839, 64.36228813559322, 64.35729386892177, 64.26160337552743, 64.18315789473684, 64.23109243697479, 64.11111111111111, 64.23640167364017, 64.45929018789144, 64.4, 64.43035343035343, 64.33609958506224, 64.22774327122153, 64.18595041322314, 64.14845360824742, 64.03086419753086, 63.96303901437371, 63.881147540983605, 63.92842535787321, 64.00408163265305, 63.88798370672098, 63.8109756097561, 63.70182555780933, 64.02429149797571, 63.93737373737374, 63.95967741935484, 63.857142857142854, 63.765060240963855, 64.0, 64.014, 64.42115768463074]

    fig, ax = plt.subplots(2, 1)
    games = len(coins)
    X = range(games)
    legend_label = ['Total per Round', 'Average Across Training']
    ax[0].plot(X, coins[:games])
    ax[0].plot(X, mean_coins[:games])
    ax[0].set_ylabel('Number of Coins')
    ax[0].set_xlim(xmin=0, xmax=games)
    ax[0].text(games+10, mean_coins[-1], f'{mean_coins[-1]:.2f}', color='#ff7f0e')
    ax[0].text(games+10, np.max(coins), f'max: {np.max(coins)}', color='#1f77b4')

    ax[1].plot(X, steps[:games])
    ax[1].plot(X, mean_steps[:games])
    ax[1].set_ylabel('Steps Survived')
    ax[1].set_xlabel('Number of Rounds')
    ax[1].set_xlim(xmin=0, xmax=games)
    ax[1].text(games+10, mean_steps[-1], f'{mean_steps[-1]:.2f}',  color='#ff7f0e')

    fig.align_xlabels
    fig.suptitle(f'Model: {MODEL_FILE[:-3]}', y=0.96)
    fig.legend(labels=legend_label, loc='upper left', bbox_to_anchor=(0.76,0.9), )
    fig.tight_layout(rect=[0,0,.8,1])
    fig.text(0.775, 0.77, f'Training Rewards: {params}', horizontalalignment='left', verticalalignment='top', bbox=dict(facecolor='none', edgecolor='#d9d9d9', boxstyle='round,pad=.5'))
    fig.set_size_inches(10, 5)
    plt.show()



if __name__ == '__main__':
    train_graph()